[template.environment]
  GQL_HOST = "WordPress URL https://satchart.com/graphql"
  NUXT_IMAGE_DOMAINS = "satchart.com"
  NODE_VERSION = "22.21.1"

[build]
  command = "NODE_OPTIONS='--max-old-space-size=4096' nuxt build"
  publish = "dist"
  NODE_VERSION = "22.21.1"

[build.environment]
  NODE_OPTIONS = "--max-old-space-size=4096"

[images]
  remote_images = ["https://i0.wp.com/*"]

# Headers to prevent caching of API endpoints
# CRITICAL: This prevents Netlify from caching API responses
# which was causing datasheet mismatches and stale product data
[[headers]]
  for = "/api/**"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate, private"
    Pragma = "no-cache"
    Expires = "0"
    X-Content-Type-Options = "nosniff"

# Specific headers for datasheet endpoint
[[headers]]
  for = "/api/products/*/datasheet"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate, private"
    Pragma = "no-cache"
    Expires = "0"
    X-Content-Type-Options = "nosniff"
    Vary = "Accept-Encoding"